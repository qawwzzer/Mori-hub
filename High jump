local config = {
    EnableHighJump = true,       -- เปิดหรือปิดระบบกระโดดสูง
    EnableWarpJump = true,       -- เปิดหรือปิดระบบวาร์ปกระโดด
    DefaultJumpPower = 20,       -- ค่ากระโดดพื้นฐานเมื่อปิด High Jump
    HighJumpPower = 50,          -- ค่ากระโดดเมื่อเปิด High Jump
    WarpJumpPower = 25,          -- ความสูงในการวาร์ปเมื่อกระโดด
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- ค่าพื้นฐาน
local defaultJumpPower = 20
local highJumpPower = 70
local maxJumpPower = 100
local warpJumpPower = 50
local highJumpEnabled = false
local warpJumpEnabled = false

-- สร้าง GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MORI_HUB"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 210)
mainFrame.Position = UDim2.new(0, 20, 0, 100)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame)

-- Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -20, 0, 25)
titleLabel.Position = UDim2.new(0, 10, 0, 10)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "MORI HUB Control Panel"
titleLabel.TextColor3 = Color3.new(1,1,1)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextScaled = true
titleLabel.Parent = mainFrame

-- High Jump Label
local jumpLabel = Instance.new("TextLabel")
jumpLabel.Size = UDim2.new(0, 150, 0, 25)
jumpLabel.Position = UDim2.new(0, 10, 0, 45)
jumpLabel.BackgroundTransparency = 1
jumpLabel.Text = "High Jump"
jumpLabel.TextColor3 = Color3.new(1,1,1)
jumpLabel.Font = Enum.Font.Gotham
jumpLabel.TextScaled = true
jumpLabel.TextXAlignment = Enum.TextXAlignment.Left
jumpLabel.Parent = mainFrame

local jumpToggle = Instance.new("TextButton")
jumpToggle.Size = UDim2.new(0, 50, 0, 25)
jumpToggle.Position = UDim2.new(0, 170, 0, 45)
jumpToggle.BackgroundColor3 = Color3.fromRGB(70,70,70)
jumpToggle.TextColor3 = Color3.new(1,1,1)
jumpToggle.Font = Enum.Font.GothamBold
jumpToggle.TextScaled = true
jumpToggle.Text = "OFF"
jumpToggle.Parent = mainFrame

local jumpInput = Instance.new("TextBox")
jumpInput.Size = UDim2.new(0, 230, 0, 25)
jumpInput.Position = UDim2.new(0, 10, 0, 75)
jumpInput.BackgroundColor3 = Color3.fromRGB(40,40,40)
jumpInput.TextColor3 = Color3.new(1,1,1)
jumpInput.Text = tostring(highJumpPower)
jumpInput.ClearTextOnFocus = false
jumpInput.Font = Enum.Font.Gotham
jumpInput.TextScaled = true
jumpInput.PlaceholderText = "ใส่ค่ากระโดด (สูงสุด 100)"
jumpInput.Parent = mainFrame

-- Warp Jump Section
local warpLabel = Instance.new("TextLabel")
warpLabel.Size = UDim2.new(0, 150, 0, 25)
warpLabel.Position = UDim2.new(0, 10, 0, 110)
warpLabel.BackgroundTransparency = 1
warpLabel.Text = "Warp Jump"
warpLabel.TextColor3 = Color3.new(1,1,1)
warpLabel.Font = Enum.Font.Gotham
warpLabel.TextScaled = true
warpLabel.TextXAlignment = Enum.TextXAlignment.Left
warpLabel.Parent = mainFrame

local warpToggle = Instance.new("TextButton")
warpToggle.Size = UDim2.new(0, 50, 0, 25)
warpToggle.Position = UDim2.new(0, 170, 0, 110)
warpToggle.BackgroundColor3 = Color3.fromRGB(70,70,70)
warpToggle.TextColor3 = Color3.new(1,1,1)
warpToggle.Font = Enum.Font.GothamBold
warpToggle.TextScaled = true
warpToggle.Text = "OFF"
warpToggle.Parent = mainFrame

local warpInput = Instance.new("TextBox")
warpInput.Size = UDim2.new(0, 230, 0, 25)
warpInput.Position = UDim2.new(0, 10, 0, 140)
warpInput.BackgroundColor3 = Color3.fromRGB(40,40,40)
warpInput.TextColor3 = Color3.new(1,1,1)
warpInput.Text = tostring(warpJumpPower)
warpInput.ClearTextOnFocus = false
warpInput.Font = Enum.Font.Gotham
warpInput.TextScaled = true
warpInput.PlaceholderText = "ใส่ความสูงในการวาร์ป (Default = 50)"
warpInput.Parent = mainFrame

-- ปุ่ม Toggle GUI แบบลากได้
local toggleButton = Instance.new("TextLabel")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 30, 0, 30)
toggleButton.Position = UDim2.new(0, 270, 0, 100)
toggleButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextScaled = true
toggleButton.Text = "M"
toggleButton.TextXAlignment = Enum.TextXAlignment.Center
toggleButton.TextYAlignment = Enum.TextYAlignment.Center
toggleButton.Parent = screenGui
toggleButton.Active = true

-- ฟังก์ชันลากปุ่ม M
local dragging, dragInput, dragStart, startPos
local function update(input)
	local delta = input.Position - dragStart
	toggleButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
									  startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

toggleButton.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = toggleButton.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

toggleButton.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)

-- คลิกปุ่ม M เพื่อเปิด/ปิด GUI
toggleButton.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		if not dragging then
			mainFrame.Visible = not mainFrame.Visible
		end
	end
end)

-- ตั้ง JumpPower
local function setJumpPower(power)
	local character = player.Character or player.CharacterAdded:Wait()
	local humanoid = character:FindFirstChildOfClass("Humanoid")
	if humanoid then
		humanoid.UseJumpPower = true
		humanoid.JumpPower = math.clamp(power, 0, maxJumpPower)
	end
end

-- High Jump Toggle
jumpToggle.MouseButton1Click:Connect(function()
	highJumpEnabled = not highJumpEnabled
	if highJumpEnabled then
		setJumpPower(tonumber(jumpInput.Text) or highJumpPower)
		jumpToggle.Text = "ON"
		jumpToggle.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
	else
		setJumpPower(defaultJumpPower)
		jumpToggle.Text = "OFF"
		jumpToggle.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
	end
end)

-- Update Jump Power input
jumpInput.FocusLost:Connect(function()
	local num = tonumber(jumpInput.Text)
	if num and num > 0 and num <= maxJumpPower then
		highJumpPower = num
		if highJumpEnabled then
			setJumpPower(highJumpPower)
		end
	else
		jumpInput.Text = tostring(highJumpPower)
	end
end)

-- Warp Toggle
warpToggle.MouseButton1Click:Connect(function()
	warpJumpEnabled = not warpJumpEnabled
	if warpJumpEnabled then
		warpToggle.Text = "ON"
		warpToggle.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
	else
		warpToggle.Text = "OFF"
		warpToggle.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
	end
end)

-- Warp Input update
warpInput.FocusLost:Connect(function()
	local num = tonumber(warpInput.Text)
	if num and num >= 1 and num <= 500 then
		warpJumpPower = num
	else
		warpInput.Text = tostring(warpJumpPower)
	end
end)

-- ตั้ง jump เริ่มต้น
setJumpPower(defaultJumpPower)

-- ฟังก์ชัน Warp Jump ตอนกระโดด
local function setupWarpJump(humanoid, rootPart)
	humanoid.Jumping:Connect(function(isJumping)
		if isJumping and warpJumpEnabled then
			rootPart.CFrame = rootPart.CFrame + Vector3.new(0, warpJumpPower, 0)
		end
	end)
end

-- โหลดตัวละครใหม่
player.CharacterAdded:Connect(function(char)
	local humanoid = char:WaitForChild("Humanoid")
	local root = char:WaitForChild("HumanoidRootPart")
	humanoid.UseJumpPower = true
	wait(0.1)
	if highJumpEnabled then
		setJumpPower(highJumpPower)
	else
		setJumpPower(defaultJumpPower)
	end
	setupWarpJump(humanoid, root)
end)

-- ถ้าตัวโหลดแล้ว
if player.Character then
	local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
	local root = player.Character:FindFirstChild("HumanoidRootPart")
	if humanoid and root then
		setupWarpJump(humanoid, root)
	end
end
